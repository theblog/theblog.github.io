<!DOCTYPE html>
<html lang="en">



<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
        <meta http-equiv="refresh" content="0; url=https://www.kilians.net/post/jekyll-github-pages-gulp-babel-directory-structure/">
        <script type="text/javascript">
            t1 = window.setTimeout(function(){ window.location.href = "https://www.kilians.net/post/jekyll-github-pages-gulp-babel-directory-structure/"; },3000);
        </script>
    <title>Directory Structure for Jekyll / GitHub Pages with Babel</title>

    
    <meta name="description" content="Ready-to-fork setup of Babel, Gulp and Jekyll for GitHub Pages">
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Directory Structure for Jekyll / GitHub Pages with Babel">
    <meta property="og:description" content="Ready-to-fork setup of Babel, Gulp and Jekyll for GitHub Pages">
    <meta property="og:url" content="https://theblog.github.io">
    <meta property="og:site_name" content="The Blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:description" content="Ready-to-fork setup of Babel, Gulp and Jekyll for GitHub Pages">
    <meta name="twitter:title" content="Directory Structure for Jekyll / GitHub Pages with Babel">
    

    
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    <link rel="manifest" href="/favicons/site.webmanifest">
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/fira.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ion-rangeslider/2.1.6/css/ion.rangeSlider.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github-gist.min.css">
    <link rel="stylesheet" href="/css/lib/ion.rangeSlider/css/ion.rangeSlider.skinFlat.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/post-util.css">
    <link rel="stylesheet" href="/css/nav.css">
    

      <link rel="stylesheet" href="https://unpkg.com/applause-button/dist/applause-button.css">

    

    
</head>

<body>



<div id="main-navbar-sticky-background"></div>

<nav role="navigation" id="main-navbar" class="navbar navbar-default">

    <div class="container-fluid">
        
        <div class="navbar-header">
            <button type="button" data-target="#main-navbar-collapse" data-toggle="collapse" class="navbar-toggle collapsed" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="navbar-brand">
                <a href="https://theblog.github.io">
                    <div id="logo-title"><img src="/images/logo.png" alt="Site logo"></div>
                    <div id="logo-subtitle">A Random Walk Through Computer Science</div>
                </a>
            </div>
        </div>

        
        <div id="main-navbar-collapse" class="collapse navbar-collapse">
            <h5><a href="https://theblog.github.io">Posts</a></h5>
            <div class="nav navbar-nav">
                
                

                
                    
                <h5 class="navigation-year">2021</h5>
                <ul>
                

                <li>
                    <a href="/post/from-tensorflow-to-pytorch/">PyTorch for TensorFlow Users - A Minimal Diff</a>
                </li>
                
                
                

                
                    
                    </ul>
                    
                <h5 class="navigation-year">2019</h5>
                <ul>
                

                <li>
                    <a href="/post/convolution-in-autoregressive-neural-networks/">Convolutions in Autoregressive Neural Networks</a>
                </li>
                
                
                

                
                    
                    </ul>
                    
                <h5 class="navigation-year">2017</h5>
                <ul>
                

                <li>
                    <a href="/post/gini-coefficient-intuitive-explanation/">Intuitive Explanation of the Gini Coefficient</a>
                </li>
                
                
                

                

                <li>
                    <a href="/post/swift-icloud-key-value-store/">iCloud Key-Value Storage in Swift 3</a>
                </li>
                
                
                

                

                <li>
                    <a class="active" href="/post/jekyll-github-pages-gulp-babel-directory-structure/">Directory Structure for Jekyll / GitHub Pages with Gulp and Babel</a>
                </li>
                
                
                

                

                <li>
                    <a href="/post/character-language-model-lstm-tensorflow/">An Interactive Character-Level Language Model</a>
                </li>
                
                
                

                
                    
                    </ul>
                    
                <h5 class="navigation-year">2016</h5>
                <ul>
                

                <li>
                    <a href="/post/visualizing-travel-times-with-multidimensional-scaling/">Visualizing Travel Times with Multidimensional Scaling</a>
                </li>
                
                
                

                
                    
                    </ul>
                    
                <h5 class="navigation-year">2015</h5>
                <ul>
                

                <li>
                    <a href="/post/some-facts-i-did-not-know-about-java/">Some facts I did not know about Java</a>
                </li>
                
                
                </ul>

            </div>
            <h5><a href="/about/">About</a></h5>
        </div>
    </div>
</nav>


<section class="wrapper">
    <div id="content" class="container-fluid">
        <div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default panel-post">
            <div class="panel-heading">
                <div class="headings">
                    <h1>Directory Structure for Jekyll / GitHub Pages with Gulp and Babel</h1>
                    
                    <h5>
                        <span><i class="fa fa-calendar-o"></i> 07 August 2017</span>
                        
                        <span><i class="fa fa-github"></i> <a href="https://github.com/batzner/github-pages-boilerplate"> Source Code</a></span>
                        
                    </h5>
                </div>
            </div>
            <div class="panel-body post-body">
                <div><ul>
    <li><strong><a href="https://jekyllrb.com/" target="_blank">Jekyll</a></strong> is the most popular static site generator.</li>
    <li><strong><a href="https://pages.github.com/" target="_blank">GitHub Pages</a></strong> hosts your jekyll sites for free under *.github.io.</li>
    <li><strong><a href="https://gulpjs.com/" target="_blank">Gulp</a></strong> lets you automate your build process (minifying .css files, concatenating all .js files etc.).</li>
    <li><strong><a href="https://babeljs.io/" target="_blank">Babel</a></strong> lets you write ES6 <i>(cool new JavaScript)</i> even though not all browsers support it by transpiling it into ES5 <i>(lame old JavaScript)</i>.</li>
</ul>

<p>I switched to using Jekyll for this blog yesterday and I love it. There are blog posts describing how to combine a subset of the above, but I could not find one for combining all four. However, each of these four components brings its own peculiarities to consider, so no blog post worked out of the box. Here is the solution that I ended up with:</p>



<h3>Result</h3>

<p>I created a <a href="https://github.com/batzner/github-pages-boilerplate/" target="_blank">boilerplate repository</a> for GitHub Pages with Gulp and Babel set up.</p>

<h5>Usage</h5>
<ol>
    <li>Fork the repo</li>
    <li>Run <code>npm install</code> in the root directory to install Gulp and Babel locally.</li>
    <li>Run <code>gulp jekyll</code> to build the site with Babel and serve it with Jekyll afterwards. Visit <a href="http://localhost:4000" target="_blank">http://localhost:4000</a> to see the blog.</li>
</ol>

<h5>Development</h5>
<p>The <code>master</code> branch should only be used for deploying (see considerations below). For development, switch to the <code>dev</code> branch. After implementing your changes, test them by running <code>gulp jekyll</code> and visiting <a href="http://localhost:4000" target="_blank">http://localhost:4000</a>.</p>

<p>If you are happy, checkout the <code>master</code> branch, merge the <code>dev</code> branch, run <code>gulp</code> to build the site into the project's root directory and push / deploy the new build to the <code>master</code> branch on GitHub.</p>

<p>Note: You can skip Babel during development by changing <code>source: _dist</code> to <code>source: src</code> and running <code>jekyll serve</code> in the root directory.</p>

<h5>Directory Structure</h5>

<p>See the <a href="https://jekyllrb.com/docs/structure/">Jekyll docs</a> for an explanation of the files and directories.</p>

<p>On <code>master</code></p>

<pre><code class="plaintext">.
├── _layouts  // built by gulp
├── _posts  // built by gulp
├── js  // built by gulp
|   ├── main.js // transpiled by Babel
├── index.html  // built by gulp
├── src
|   ├── _layouts
|   ├── _posts
|   ├── js
|       ├── main.js // in ES6
|   ├── index.html
├── _config.yml
├── gulpfile.js
├── package.json
├── README.md
├── .gitignore</code></pre>

<p>On <code>dev</code></p>

<pre><code class="plaintext">.
├── _dist // built by gulp
|   ├── _layouts
|   ├── _posts
|   ├── js
|       ├── main.js // transpiled by Babel
|   ├── index.html
├── src
|   ├── _layouts
|   ├── _posts
|   ├── js
|       ├── main.js // in ES6
|   ├── index.html
├── _config.yml
├── gulpfile.js
├── package.json
├── README.md
├── .gitignore</code></pre>

<h3>Considerations</h3>

<ul>
    <li>Running Babel for transpiling the ES6 files into ES5 before each deployment of the site is not practical, so a build tool like Gulp that runs Babel automatically is a must.</li>
    <li>There is a <a href="https://github.com/babel/jekyll-babel" target="_blank">jekyll-babel Jekyll plugin</a> but you have to start each .js file with exactly
        <pre><code class="plaintext">---<br>---</code></pre>
        WebStorm does not like that and formats it wrongly every time. If you try to escape that block with <code>// @formatter:off</code>, the Jekyll plugin won't work anymore. Also, it is a bit dirty to mess with the .js files. If I want to directly run them during development, they will error. So, Babel has to be called by Gulp.
    </li>
    <li>Babel will generate the transpiled .js files somewhere. I don't want these files to mingle with the actual source .js files - that would cause confusion. So, using a <code>src</code> and a <code>_dist</code> directory (ignored by git) would be clean. Jekyll can then generate the static site in <code>_site</code> by using the files in <code>_dist</code>.</li>
    <li>You have to commit all files that Jekyll needs to the <code>master</code> branch on GitHub. So <code>_dist</code> must not be ignored by git. At the same time it is generated code so it should be ignored. A solution is to ignore <code>_dist</code> on the <code>dev</code> branch. Then, merge the <code>dev</code> branch to the <code>master</code> branch, run Gulp and push the new <code>_dist</code> to the GitHub <code>master</code> branch.</li>
    <li>For running Jekyll on the <code>_dist</code> directory, you would have to specify <code>source: _dist</code> in Jekyll's <code>_config.yml</code>. However, GitHub overrides the <code>source</code> setting, which you cannot change (<a href="https://help.github.com/articles/configuring-jekyll/#configuration-settings-you-cannot-change" target="_blank">GitHub docs</a>). So Jekyll's source directory <strong>has to be the repo's top level directory</strong> (for username.github.io pages). You also <strong>must</strong> commit the page to the <code>master</code> branch. The solution is to keep the <code>source: _dist</code> setting for the <code>dev</code> branch, but let gulp build the site into the root directory on the <code>master</code> branch (<a href="https://help.github.com/articles/configuring-a-publishing-source-for-github-pages/" target="_blank">docs</a>).</li>
</ul>

<h3>Drawbacks</h3>

<ul>
    <li>On <code>master</code>, Gulp cannot clean the build directory before building because it is the project's root directory.</li>
    <li>You have to go to <code>master</code>, build and push for every deployment of the site. <a href="https://github.com/shinnn/gulp-gh-pages">The <code>gulp-gh-pages</code> gulp plugin</a> might help with that.</li>
    <li>On <code>master</code>, I had to change <code>_config.yml</code> and <code>gulpfile.js</code> to make Gulp build into the root directory. Thus, changes to these files in <code>dev</code> will have to be merged manually with master.</li>
</ul>

</div>

                <h3>Like what you read?</h3>
                <div>
                    <div class="clearfix">
                    <div><applause-button url="https://theblog.github.io/jekyll-github-pages-gulp-babel" multiclap="false" color="rgb(10, 18, 79)"></div>
                    <p>I don't use Google Analytics or Disqus because they require cookies. I would still like to know
                        which posts are popular, so if you liked this post you can let me know here on the right.</p>
                    </div>
                    <p>You can also leave a comment if you have a GitHub account. The "Sign in" button will store the GitHub API token in a cookie.</p>
                    <script src="https://utteranc.es/client.js" repo="theblog/blog-comments" issue-term="jekyll-github-pages-gulp-babel" theme="github-light" crossorigin="anonymous" async>
                    </script>
                </div>
                <div>
                </div>

            </div>
        </div>
    </div>
</div>
    </div>
</section>
<footer class="footer">
    <div>Powered by <a href="https://github.com/jekyll/jekyll" target="_blank">Jekyll</a>.</div>
    <div style="margin-top: 5px"><a href="https://www.iubenda.com/privacy-policy/63560500/legal" style="color:inherit">Imprint and Privacy Policy</a></div>
</footer>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>

<script src="/js/general.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  <script src="https://unpkg.com/applause-button/dist/applause-button.js"></script>
  <script src="/js/post.js"></script>
  <script src="/js/post-util.js"></script>



</body>

</html>
